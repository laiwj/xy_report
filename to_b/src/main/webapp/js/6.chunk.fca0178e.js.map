{"version":3,"sources":["webpack:///./src/modules/login/login.js","webpack:///./src/assets/css/login/login.css"],"names":[],"mappings":";;;;;0CAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,0BAAyB,GAAG;AAC5B;AACA;AACA,UAAS;AACT;AACA,yEAAwE,EAAE;AAC1E;AACA;AACA;AACA,cAAa;AACb,sFAAqF,IAAI;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,mDAAkD,EAAE,QAAQ;AAC5D;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,C;;;;;;;;AC9GD,0C","file":"js/6.chunk.fca0178e.js","sourcesContent":["require('../../assets/css/login/login.css');\r\nvar host = require('../../config').requestHost();\r\nvar setCookie = require('../../config').setCookie;\r\nvar loginVm = avalon.define({\r\n    $id: 'login',\r\n    loginStatus: '登录',\r\n    form: {\r\n        account: '',\r\n        password: ''\r\n    },\r\n    isCorrect: function(value) {\r\n        var isNum = /^\\d{11}$/;\r\n        if (value.trim().length === 0) {\r\n            return false\r\n        } else {\r\n            if (isNum.test(value)) {\r\n                var reg = /^1((3[0-9]|4[57]|5[0-35-9]|7[0678]|8[0-9])\\d{8}$)/;\r\n                if (!reg.test(value)) {\r\n                    return false\r\n                }\r\n            } else {\r\n                var email = /^([a-zA-Z0-9_\\.\\-])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\r\n                if (!email.test(value)) {\r\n                    return false\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n    isPassword: function(value) {\r\n        var pass = /[`~!@#\\$%\\^\\&\\*\\(\\)_\\+<>\\?:\"\\{\\},\\.\\\\\\/;'\\[\\]]/im;\r\n        if (value.trim().length === 0) {\r\n            return false\r\n        }\r\n        if (pass.test(value)) {\r\n            return false\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n    validate: function(type, e) {\r\n        var parent = this.parentNode;\r\n        var value = this.value;\r\n        if (type === 'account') {\r\n            if (!loginVm.isCorrect(value)) {\r\n                avalon(parent).addClass('error');\r\n                return false;\r\n            }\r\n        } else {\r\n            if (!loginVm.isPassword(value)) {\r\n                avalon(parent).addClass('error');\r\n            }\r\n        }\r\n    },\r\n\r\n    focus: function(e) {\r\n        avalon(this.parentNode).addClass('focus').removeClass('error');\r\n    },\r\n    blur: function(e) {\r\n        avalon(this.parentNode).removeClass('focus');\r\n    },\r\n    submitHandler: function(e) {\r\n        e.preventDefault();\r\n        if (!loginVm.isCorrect(loginVm.form.account)) {\r\n            var el = document.getElementById('account');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false\r\n        }\r\n        if (!loginVm.isPassword(loginVm.form.password)) {\r\n            var el = document.getElementById('password');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false\r\n        }\r\n        var a = {\r\n            account: loginVm.form.account,\r\n            password: loginVm.form.password\r\n        }\r\n        avalon.vmodels.root.showLoading = true;\r\n        this.loginStatus = \"正在登录...\";\r\n        $.post(host + '/user/login', a, function(data) {\r\n            if (data.code === 0) {\r\n                setCookie('userName', data.data.username);\r\n                avalon.vmodels.root.userName = data.data.username;\r\n                avalon.vmodels.root.isLogin = true;\r\n                avalon.router.go('homePage');\r\n            } else {\r\n                avalon.vmodels.root.showMessage(data.msg);\r\n            }\r\n            this.loginStatus = \"登录\";\r\n            avalon.vmodels.root.showLoading = false;\r\n        })\r\n    }\r\n});\r\nmodule.exports = avalon.controller(function($ctrl) {\r\n    // 视图渲染后，意思是avalon.scan完成\r\n    $ctrl.$onRendered = function() {\r\n            avalon.vmodels.root.menuShow = false;\r\n            $('.page_container').addClass('page-container').removeClass('page_container');\r\n        }\r\n        // 进入视图\r\n    $ctrl.$onEnter = function() {\r\n            loginVm.form.account = loginVm.form.account || avalon.vmodels.root.register.account;\r\n            loginVm.form.password = loginVm.form.password || avalon.vmodels.root.register.password;\r\n        }\r\n        // 对应的视图销毁前\r\n    $ctrl.$onBeforeUnload = function() {\r\n            $('.page-container').addClass('page_container').removeClass('page-container');\r\n        }\r\n        // 指定一个avalon.scan视图的vmodels，vmodels = $ctrl.$vmodels.concact(DOM树上下文vmodels)\r\n    $ctrl.$vmodels = []\r\n})\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/modules/login/login.js\n// module id = 32\n// module chunks = 6","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/css/login/login.css\n// module id = 33\n// module chunks = 6"],"sourceRoot":""}