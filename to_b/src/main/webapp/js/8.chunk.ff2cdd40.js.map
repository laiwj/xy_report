{"version":3,"sources":["webpack:///./src/modules/register/register.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA,UAAS;AACT,MAAK;AACL;AACA,0BAAyB,GAAG;AAC5B;AACA;AACA,UAAS;AACT;AACA,yEAAwE,EAAE;AAC1E;AACA;AACA;AACA,cAAa;AACb,sFAAqF,IAAI;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,mDAAkD,EAAE,QAAQ;AAC5D;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,C","file":"js/8.chunk.ff2cdd40.js","sourcesContent":["var host = require('../../config').requestHost();\r\nvar registerVm = avalon.define({\r\n    $id: 'register',\r\n    registerStatus: '注册',\r\n    username: '',\r\n    account: '',\r\n    inviter: '',\r\n    password: '',\r\n    registerClick: function(e) {\r\n        e.preventDefault();\r\n        if (!registerVm.isCorrect(registerVm.account)) {\r\n            var el = document.getElementById('account');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false;\r\n        }\r\n        if (!registerVm.isPassword(registerVm.password)) {\r\n            var el = document.getElementById('password');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false;\r\n        }\r\n        if (!registerVm.isPassword(registerVm.username)) {\r\n            var el = document.getElementById('username');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false;\r\n        }\r\n        if (!registerVm.isPassword(registerVm.inviter)) {\r\n            var el = document.getElementById('inviter');\r\n            avalon(el.parentNode).addClass('error');\r\n            return false;\r\n        }\r\n        avalon.vmodels.root.showLoading = true;\r\n        registerVm.registerStatus = \"正在注册...\";\r\n        var formData = {\r\n            username: registerVm.username,\r\n            password: registerVm.password,\r\n            account: registerVm.account,\r\n            inviter: registerVm.inviter\r\n        }\r\n        $.post(host + '/user/regist', formData, function(data) {\r\n            registerVm.registerStatus = \"注册\";\r\n            if (data.code === 0) {\r\n                if (avalon.vmodels.login) {\r\n                    avalon.vmodels.login.form = {\r\n                        account: registerVm.account,\r\n                        password: registerVm.password\r\n                    }\r\n                } else {\r\n                    avalon.vmodels.root.register = {\r\n                        account: registerVm.account,\r\n                        password: registerVm.password\r\n                    }\r\n                }\r\n                avalon.router.go('login');\r\n            } else {\r\n                avalon.vmodels.root.showMessage(data.msg);\r\n            }\r\n            avalon.vmodels.root.showLoading = false;\r\n\r\n        })\r\n    },\r\n    isCorrect: function(value) {\r\n        var isNum = /^\\d{11}$/;\r\n        if (value.trim().length === 0) {\r\n            return false\r\n        } else {\r\n            if (isNum.test(value)) {\r\n                var reg = /^1((3[0-9]|4[57]|5[0-35-9]|7[0678]|8[0-9])\\d{8}$)/;\r\n                if (!reg.test(value)) {\r\n                    return false\r\n                }\r\n            } else {\r\n                var email = /^([a-zA-Z0-9_\\.\\-])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\r\n                if (!email.test(value)) {\r\n                    return false\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n    isPassword: function(value) {\r\n        var pass = /[`~!@#\\$%\\^\\&\\*\\(\\)_\\+<>\\?:\"\\{\\},\\.\\\\\\/;'\\[\\]]/im;\r\n        if (value.trim().length === 0) {\r\n            return false\r\n        }\r\n        if (pass.test(value)) {\r\n            return false\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n    focus: function() {\r\n        avalon(this.parentNode).addClass('focus').removeClass('error');\r\n    },\r\n    blur: function() {\r\n        avalon(this.parentNode).removeClass('focus');\r\n    },\r\n    validateUs: function() {\r\n        if (!registerVm.isPassword(this.value)) {\r\n            avalon(this.parentNode).addClass('error');\r\n        }\r\n    },\r\n    validateAc: function() {\r\n        if (!registerVm.isCorrect(this.value)) {\r\n            avalon(this.parentNode).addClass('error');\r\n        }\r\n    },\r\n    validatePs: function() {\r\n        if (!registerVm.isPassword(this.value)) {\r\n            avalon(this.parentNode).addClass('error');\r\n        }\r\n    },\r\n    validateNum: function() {\r\n        var a = this.value;\r\n        if (!registerVm.isPassword(a)) {\r\n            avalon(this.parentNode).addClass('error');\r\n        }\r\n    }\r\n});\r\nmodule.exports = avalon.controller(function($ctrl) {\r\n    // 视图渲染后，意思是avalon.scan完成\r\n    $ctrl.$onRendered = function() {\r\n            var el = document.querySelector('.page_container');\r\n            avalon(el).addClass('page-container').removeClass('page_container');\r\n        }\r\n        // 进入视图\r\n    $ctrl.$onEnter = function() {\r\n            registerVm.inviter = location.hash.split('=')[1] || '';\r\n        }\r\n        // 对应的视图销毁前\r\n    $ctrl.$onBeforeUnload = function() {\r\n            var el = document.querySelector('.page-container');\r\n            avalon(el).addClass('page_container').removeClass('page-container');\r\n        }\r\n        // 指定一个avalon.scan视图的vmodels，vmodels = $ctrl.$vmodels.concact(DOM树上下文vmodels)\r\n    $ctrl.$vmodels = []\r\n})\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/modules/register/register.js\n// module id = 35\n// module chunks = 8"],"sourceRoot":""}