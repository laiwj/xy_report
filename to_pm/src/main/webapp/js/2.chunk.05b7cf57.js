webpackJsonp([2,13],{35:function(o,n,t){var i,e;(function(t){i=[],e=function(){var o=avalon.define({$id:"login",isSumbit:!1,account:"",password:null,email_hint:!0,initEditData:function(){var n=o.getPassFromCookie();if(n){var i=n.split("|");o.account=i[0],o.password=i[1],i[1]&&t(".J_password_remember").attr("checked","checked")}},initDomListener:function(){t(document).on("keydown",function(o){13==o.keyCode&&t("#J_login").click()}),t("#login_password").blur(function(){/^[a-z0-9_-]{1,16}$/.test(t("#login_password").val())?t(".password_hint").html("✔").css("color","green"):t(".password_hint").html("×").css("color","red")}),t("#login_account").blur(function(){"admin"==t("#login_account").val()?(t(".email_hint").html("✔").css("color","green"),o.email_hint=!1):/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(t("#login_account").val())?(t(".email_hint").html("✔").css("color","green"),o.email_hint=!1):/^1[34578]\d{9}$/.test(t("#login_account").val())?(t(".email_hint").html("✔").css("color","green"),o.email_hint=!1):(t(".email_hint").html("×").css("color","red"),o.email_hint=!0)})},loginFun:function(){if(""==t("#login_password").val()||""==t("#login_account").val())return t(".alert-login").text("请输入账号或密码").show(),void setTimeout(function(){t(".alert-login").hide()},2e3);if(o.email_hint)return t(".alert-login").text("邮箱或手机格式有误").show(),void setTimeout(function(){t(".alert-login").hide()},2e3);if(!o.isSumbit){t("#login_password").val();t("#J_login").text("正在登录...");var n={account:o.account,password:o.password},i="/user/login";o.isSumbit=!0,t.post(i,n,function(n){if(o.isSumbit=!1,t("#J_login").text("登录"),0!==n.code)return t(".alert-login").text(n.msg).show(),setTimeout(function(){t(".alert-login").hide()},1e3),!1;var i=n.data._id+"|"+n.data.type+"|"+n.data.short_id+"|"+n.data.username;window.$.cookie(location.host+"_userinfo",i,{expires:365});var e=n.data.username+"|"+n.data.password;document.getElementById("J_password_remember").checked?o.savePassToCookie(e):o.clearPassToCookie(),window.$.cookie(location.host+"_userInfoResult",""),window.location.href="/#!/report"})}},savePassToCookie:function(o){window.$.cookie(location.host+"_password",o,{expires:365})},getPassFromCookie:function(){return window.$.cookie(location.host+"_password")},clearPassToCookie:function(){window.$.cookie(location.host+"_password","",{path:"/"})}});return avalon.controller(function(n){n.$onRendered=function(){document.title="登录",o.initEditData(),o.initDomListener()},n.$onEnter=function(o,n,t){},n.$onBeforeUnload=function(){},n.$vmodels=[o]})}.apply(n,i),!(void 0!==e&&(o.exports=e))}).call(n,t(33))}});